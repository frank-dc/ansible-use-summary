# 原码、反码和补码
- [原码、反码和补码](#原码反码和补码)
  - [概念](#概念)
  - [位运算](#位运算)
  - [移位运算](#移位运算)
  - [位操作常见用途](#位操作常见用途)
  - [总结](#总结)


## 概念
原码：是最基本的表示有符号整数的方式，其中最高位表示数的符号，`0`表示整数，`1`表示负数。其余位表示数的绝对值。例如，+5的原码是 `0000 0101`，-5的原码是 `1000 0101`。

反码：在原码的基础上，对负数取反。即符号位不变，其它位取反。例如，+5的反码依然是 `0000 0101`，而-5的反码是 `1111 1010`。

补码：在反码的基础上，再加1。补码解决了反码在加法运算时的一个问题，即负数相加可能会产生进位，导致结果错误的情况。补码的优点是可以统一对待正数和负数的加法运算。例如，+5 的补码仍然是 `0000 0101`，而 -5 的补码是 `1111 1011`。

## 位运算
位运算是计算机中对二进制位进行操作的一种数学运算。位运算包括按位与(AND)，按位或(OR)，按位异或(XOR)，按位取反(NOT)等操作。这些操作通常用于处理二进制数据、优化算法、以及在低级别编程中进行优化或实现特定功能。

* 按位与: 只有当两个操作数的对应位都为1时，结果位才为1。符号是`&`
* 按位或: 只要两个操作数的对应位中有一个为1，结果位就为1。符号是`|`
* 按位异或: 当两个操作数的对应位不相同时，结果位为1。符号是`^`
* 按位取反: 对操作数的每个位进行取反操作，即将0变为1，将1变为0。符号是`~`

例如，`3 & -2`，`3 | -2`，`3 ^ -2`值分别为？
```
3 的补码：0000 0011
-2 的补码：1111 1110(原码：1000 0010，反码：1111 1101)
```
| 运算      | 补码结果 | 反码结果 | 原码结果 | 十进制 |
| ----------- | ----------- | ----------- | ----------- | ----------- |
| 3 & -2      | 0000 0010 | 0000 0010 | 0000 0010 | 2 | 
| 3 \| -2   | 1111 1111 | 1111 1110 | 1000 0001 | -1 |
| 3 ^ -2   | 1111 1101 | 1111 1100 | 1000 0011 | -3 |

再例如，减法运算 `3 - 4`等价于`3 + (-4)`
```
3 的补码：0000 0011
-4 的补码：1111 1100（原码：1000 0100，反码：1111 1011）
```
| 运算      | 补码结果 | 反码结果 | 原码结果 | 十进制 |
| ----------- | ----------- | ----------- | ----------- | ----------- |
| 3 - 4      | 1111 1111 | 1111 1110 | 1000 0001 | -1 | 

## 移位运算
* 左移：将操作数的所有位向左移动指定的位数，右侧空出的位用0填充。
* 右移：将操作数的所有位向右移动指定的位数，符号位固定，其它位向右移动，低位溢出，符号位和中间缺失的位补0。

> 技巧：左移一位相当于乘2，右移一位相当于除2（但1右移1位后为0）。

## 位操作常见用途
* 位与&：常用来与对应位为1的值位与，取出值中的部分存在位，特别是存在于中间的某几位
* 位或|：常用来合并设置。例如open()文件时，使用|符号合并多个打开文件的模式
* 异或^：常用来找出只有单边设置了的属性，即找不同。例如找出两个数据中的不同字符(如Ruby和ruby哪里不同)
* 移位：通常用于取边缘位、按2的倍数扩大或缩小

## 总结
* 0 和 正数的原码、反码和补码全一样。
* 计算机运算时，都取补码来运算，运算的结果也是补码。
* 
